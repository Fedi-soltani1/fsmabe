import{j as S,i as N,a as T,b as A,c as D,d as I,e as B,f as O,_ as j,A as M,S as z,g as W,h as q,H as L}from"./hook-in.js";import{F as E}from"./FileInput.js";import{r as V,c as i,o,w as s,a as r,d as p,b as a,_ as w,g as m,t as u,C as k,e as h,f as b,h as R,i as Y,$ as Z,a0 as f,a1 as H,v as P,j as n,l as v,G as c,a2 as C,a3 as $,k as g,p as G,q as J}from"./vendor.js";const K={name:"Whistleblower",components:{FileInput:E,ApplicationWrapper:M},mixins:[j],data:()=>({allowedFilesTranslation:Drupal.t("Allowed types: doc, docx, xls, xlsx, ppt, pptx, pdf, wav, zip, 7z, xml, txt, jpg, jpeg, png, msg",{},{context:"whistleblowing"}),whistle:"",anonymous:!1,firstname:"",lastname:"",street:"",number:"",zipCode:"",city:"",country:"",tel:"",tel2:"",email:"",attachments:[],subject:"",information:"",submitting:!1,submitted:!1,snackShow:!1,snackType:"",timeout:5e3,snackMessage:"",rules:{required:O,isEmail:B,isName:I,isStreet:D,isNumberOrZipcode:A,isCityOrCountry:T,isTelephone:N,checkFileImage:S},regName:null,regFullName:null,filesCombined:[],textAccepted:!1,formValid:null}),computed:{counterSizeString:function(){return this.attachments.length<=1?Drupal.t("{0} file {1} in total"):Drupal.t("{0} files {1} in total")},subsite:function(){let e="";return drupalSettings!=null&&drupalSettings.subsite&&(e=drupalSettings.subsite),e},whistleblowerText(){const e=W(),l=this.$store.state.pdb[`${e.toUpperCase()}_pointOfContactUrl`]||"";return this.subsite?Drupal.t('Before submitting a report, please read the <a href="@url" target="_blank">text</a> explaining whistleblower reports',{"@url":l},{context:"ctr_whistleblowing"}):Drupal.t('Before submitting a report, please read the <a href="@url" target="_blank">text</a> explaining whistleblower reports',{"@url":l})}},methods:{updateFiles(e){this.attachments=e},async submitWhistle(){if(this.regFullName===null&&this.regName===null&&this.$refs.regFullName.value===""&&this.$refs.regName.value===""){const e=z.get("Whistleblower");if(this.submitting=!0,await this.$refs.whistleForm.validate(),this.formValid){const l={notification:{subject:this.subject||"",information:this.information||"",submitted:new Date().toISOString(),userStatus:this.anonymous?"Anonymous":"UserUnknown"},attachments:this.attachments};this.anonymous||(l.user={firstName:this.firstname,lastName:this.lastname,number:this.number,street:this.street,zipCode:this.zipCode,city:this.city,country:this.country,phone:this.tel,email:this.email,phone2:this.tel2}),e.addWithFiles(l).then(y=>{this.submitting=!1,this.submitted=!0,this.whistle=y.data,this.snackShow=!0,this.snackType="succes",this.snackMessage=Drupal.t("Report successfully submitted!")}).catch(()=>{this.submitting=!1,this.snackShow=!0,this.snackType="error",this.snackMessage=Drupal.t("Something went wrong during your report submission!")})}else this.formValid=!1,this.submitting=!1}else this.formValid=!1,this.snackMessage=Drupal.t("Something went wrong during your report submission!")},cancel(){window.history.back()},deleteChip(e){this.attachments.splice(e,1),this.filesCombined.splice(e,1)},clearFiles(){this.attachments=[],this.filesCombined=[]}}},Q={class:"whistleblower"},X={class:"text-h5 font-weight-bold mb-6 primary--text"},x={class:"d-sr-only"},_={key:0},ee={class:"regularField","aria-hidden":"true"},le=["innerHTML"],te={class:"d-flex align-center ma-n2"};function ae(e,l,y,oe,ie,d){const F=V("FileInput"),U=V("ApplicationWrapper");return o(),i(U,null,{default:s(()=>[r("div",Q,[d.subsite?(o(),i(w,{key:0,class:"alert-border-full-opacity py-4 pr-3 my-3","border-color":"blue",color:"white",border:"start",elevation:"2"},{prepend:s(()=>[a(k,{color:"blue",icon:"mdi:mdi-information"})]),text:s(()=>[m(u(e.t("You first need to indicate whether you want to send your contact details to the BAOB or whether you prefer an anonymous report. Please bear in mind that the Belgian Audit Oversight Board cannot get in touch with you if you file an anonymous report; you may opt to enter only an email address or a telephone number in the contact information, without giving a name.",{},{context:"ctr_whistleblowing"})),1)]),_:1})):(o(),i(w,{key:1,class:"alert-border-full-opacity py-4 pr-3 my-3","border-color":"info",color:"white",border:"start",elevation:"2"},{prepend:s(()=>[a(k,{color:"info",icon:"mdi:mdi-information"})]),text:s(()=>[m(u(e.t("You first need to indicate whether you want to send your contact details to the FSMA or whether you prefer an anonymous notification.")),1)]),_:1})),e.submitted?(o(),i(h,{key:2},{default:s(()=>[a(b,{cols:"12"},{default:s(()=>[r("span",X,u(e.t("Report submission successful:")),1)]),_:1})]),_:1})):p("",!0),e.submitted?(o(),i(h,{key:3},{default:s(()=>[a(b,{cols:"12"},{default:s(()=>[m(u(e.t("Your report ID:"))+" "+u(e.whistle),1)]),_:1})]),_:1})):p("",!0),a(R,{ref:"whistleForm",onSubmit:l[18]||(l[18]=Y(()=>{},["prevent"])),modelValue:e.formValid,"onUpdate:modelValue":l[19]||(l[19]=t=>e.formValid=t)},{default:s(()=>[a(h,null,{default:s(()=>[a(b,{cols:"12",sm:6,class:"pr-sm-2"},{default:s(()=>[a(Z,{modelValue:e.anonymous,"onUpdate:modelValue":l[0]||(l[0]=t=>e.anonymous=t),readonly:e.submitted},{label:s(()=>[r("label",x,u(e.t("Contact Type")),1)]),default:s(()=>[d.subsite?(o(),i(f,{key:0,label:e.t("I transfer my contact details to the BAOB",{},{context:"ctr_whistleblowing"}),value:!1,color:"primary"},null,8,["label"])):(o(),i(f,{key:1,label:e.t("I transfer my contact details to the FSMA"),value:!1,color:"primary"},null,8,["label"])),d.subsite?(o(),i(f,{key:2,label:e.t("I opt for an anonymous report",{},{context:"ctr_whistleblowing"}),value:!0,color:"primary"},null,8,["label"])):(o(),i(f,{key:3,label:e.t("I opt for an anonymous notification"),value:!0,color:"primary"},null,8,["label"]))]),_:1},8,["modelValue","readonly"]),a(H,null,{default:s(()=>[e.anonymous?p("",!0):(o(),P("div",_,[a(n,{modelValue:e.firstname,"onUpdate:modelValue":l[1]||(l[1]=t=>e.firstname=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Firstname"),readonly:e.submitted,maxlength:"50",rules:[e.rules.isName]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.lastname,"onUpdate:modelValue":l[2]||(l[2]=t=>e.lastname=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Lastname"),readonly:e.submitted,maxlength:"50",rules:[e.rules.isName]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.street,"onUpdate:modelValue":l[3]||(l[3]=t=>e.street=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Street"),readonly:e.submitted,maxlength:"50",rules:[e.rules.isStreet]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.number,"onUpdate:modelValue":l[4]||(l[4]=t=>e.number=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Number"),readonly:e.submitted,oninput:"javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);",maxlength:"10",rules:[e.rules.isNumberOrZipcode]},null,8,["modelValue","label","readonly","rules"]),d.subsite?(o(),i(n,{key:0,modelValue:e.zipCode,"onUpdate:modelValue":l[5]||(l[5]=t=>e.zipCode=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Postal code",{},{context:"ctr_whistleblowing"}),readonly:e.submitted,maxlength:"10",rules:[e.rules.isNumberOrZipcode]},null,8,["modelValue","label","readonly","rules"])):(o(),i(n,{key:1,modelValue:e.zipCode,"onUpdate:modelValue":l[6]||(l[6]=t=>e.zipCode=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Zip code"),readonly:e.submitted,maxlength:"10",rules:[e.rules.isNumberOrZipcode]},null,8,["modelValue","label","readonly","rules"])),a(n,{modelValue:e.city,"onUpdate:modelValue":l[7]||(l[7]=t=>e.city=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("City"),readonly:e.submitted,maxlength:"50",rules:[e.rules.isCityOrCountry]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.country,"onUpdate:modelValue":l[8]||(l[8]=t=>e.country=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Country"),readonly:e.submitted,maxlength:"30",rules:[e.rules.isCityOrCountry]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.tel,"onUpdate:modelValue":l[9]||(l[9]=t=>e.tel=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Telephone"),readonly:e.submitted,maxlength:"20",rules:[e.rules.isTelephone]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.tel2,"onUpdate:modelValue":l[10]||(l[10]=t=>e.tel2=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Telephone 2"),readonly:e.submitted,maxlength:"20",rules:[e.rules.isTelephone]},null,8,["modelValue","label","readonly","rules"]),a(n,{modelValue:e.email,"onUpdate:modelValue":l[11]||(l[11]=t=>e.email=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("E-mail"),readonly:e.submitted,maxlength:"50",rules:[e.rules.isEmail]},null,8,["modelValue","label","readonly","rules"])]))]),_:1})]),_:1}),a(b,{cols:"12",sm:6,class:"pl-sm-2"},{default:s(()=>[a(F,{"form-valid":!0,"is-required":!1,onFilesUpdated:d.updateFiles,context:"whistleblowing"},null,8,["onFilesUpdated"]),a(n,{modelValue:e.subject,"onUpdate:modelValue":l[12]||(l[12]=t=>e.subject=t),variant:"solo-filled",flat:"",density:"compact",label:e.t("Subject"),rules:[e.rules.required],readonly:e.submitted},null,8,["modelValue","label","rules","readonly"]),d.subsite?(o(),i(v,{key:0,modelValue:e.information,"onUpdate:modelValue":l[13]||(l[13]=t=>e.information=t),variant:"solo-filled",flat:"",label:e.t("Description of the report"),density:"compact",rules:[e.rules.required],readonly:e.submitted},null,8,["modelValue","label","rules","readonly"])):(o(),i(v,{key:1,modelValue:e.information,"onUpdate:modelValue":l[14]||(l[14]=t=>e.information=t),variant:"solo-filled",flat:"",label:e.t("Description of the message"),density:"compact",rules:[e.rules.required],readonly:e.submitted},null,8,["modelValue","label","rules","readonly"]))]),_:1})]),_:1}),r("fieldset",ee,[l[22]||(l[22]=r("label",{class:"regularField",for:"name"},null,-1)),c(r("input",{id:"name",ref:"regName","onUpdate:modelValue":l[15]||(l[15]=t=>e.regName=t),class:"regularField",autocomplete:"no",type:"text",name:"name",placeholder:"Your name here"},null,512),[[C,e.regName]]),l[23]||(l[23]=r("label",{class:"regularField",for:"fullname"},null,-1)),c(r("input",{id:"fullname",ref:"regFullName","onUpdate:modelValue":l[16]||(l[16]=t=>e.regFullName=t),class:"regularField",autocomplete:"no",type:"text",name:"fullname",placeholder:"Your fullname here"},null,512),[[C,e.regFullName]])]),r("span",{innerHTML:d.whistleblowerText},null,8,le),a($,{modelValue:e.textAccepted,"onUpdate:modelValue":l[17]||(l[17]=t=>e.textAccepted=t),label:e.t("I have read the text")},null,8,["modelValue","label"]),r("div",te,[e.submitted?p("",!0):(o(),i(g,{key:0,disabled:!e.textAccepted,type:"submit",color:"primary",class:"ma-2 px-4",loading:e.submitting,onClick:d.submitWhistle},{default:s(()=>[m(u(e.t("Send",{},{context:"whistleblowing"}).toUpperCase()),1)]),_:1},8,["disabled","loading","onClick"])),a(g,{variant:"text",class:"ma-2 px-4 text-primary font-weight-bold",onClick:d.cancel},{default:s(()=>[m(u(e.t("cancel").toUpperCase()),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),a(G,{modelValue:e.snackShow,"onUpdate:modelValue":l[21]||(l[21]=t=>e.snackShow=t),timeout:e.timeout,rounded:"pill",color:e.snackType},{action:s(({attrs:t})=>[a(g,J({color:"blue",text:""},t,{onClick:l[20]||(l[20]=ne=>e.snackShow=!1)}),{default:s(()=>[m(u(e.t("close")),1)]),_:2},1040)]),default:s(()=>[m(u(e.snackMessage)+" ",1)]),_:1},8,["modelValue","timeout","color"])])]),_:1})}const se=q(K,[["render",ae],["__scopeId","data-v-61eca0f2"]]);L("fsma_whistleblower",se);
