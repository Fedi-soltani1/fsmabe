/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,Drupal,once){const DEBUG=false;Drupal.behaviors.masonryFormatter={attach:function(context,settings){once('masonry-formatter','.masonry-grid',context).forEach(function(element){const $grid=$(element);function getCurrentBreakpoint(){var containerWidth=$('.content-container').outerWidth();let viewPort;if(containerWidth<720)viewPort='mobile';else if(containerWidth>=720&&containerWidth<960)viewPort='tablet-small';else if(containerWidth>=960&&containerWidth<1110)viewPort='tablet-big';else viewPort='desktop';if(DEBUG)console.log('Viewport: ',viewPort);return viewPort;}function initMasonry(){if(DEBUG)console.log('Initializing Masonry.');$grid.find('.masonry-item').css('transition','none');$grid.masonry({itemSelector:'.masonry-item',percentPosition:true,fitWidth:true,columnWidth:'.masonry-item.small',gutter:settings.masonryFormatter.gutter,transitionDuration:'0.3s'});const $emptyItems=$grid.find('.masonry-item.empty');if('mobile'==$grid.data('breakpoint')||'tablet-small'==$grid.data('breakpoint'))$emptyItems.hide();else $emptyItems.show();setTimeout(function(){$grid.masonry('option',{transitionDuration:'0.3s'});$grid.find('.masonry-item').css('transition','all 0.3s ease');$grid.masonry('layout');},100);}function resizer(){var currentBreakpoint=getCurrentBreakpoint();var storedBreakpoint=$grid.data('breakpoint');if(storedBreakpoint!==currentBreakpoint){$grid.data('breakpoint',currentBreakpoint);$grid.masonry('destroy');initMasonry();}}function replaceBackground($tile,stateType){if(!settings.masonryFormatter||!settings.masonryFormatter.tileStyles){console.warn('Masonry tile styles not found in drupalSettings');return;}const tileStyles=settings.masonryFormatter.tileStyles;const tileType=$tile.data('tile-type');let size;if($tile.hasClass('big'))size='big';else{if($tile.hasClass('small'))size='small';}if(tileStyles[size]&&tileStyles[size][tileType]&&tileStyles[size][tileType][stateType]){if('keyboard-focus'==stateType)$tile.addClass('keyboard-focus');else $tile.removeClass('keyboard-focus');let currentBackground=$tile.css('background');let currentUrlMatch=currentBackground.match(/url\(['"](.*?)['"]\)/);let currentUrl=currentUrlMatch?currentUrlMatch[1]:'';let newStyle=tileStyles[size][tileType][stateType];if(currentUrl&&newStyle.indexOf('url(')>=0){newStyle=newStyle.replace(/url\(['"]?([^'"]+)['"]?\)/,'url("'+currentUrl+'")');let currentStyle=$tile.attr('style')||'';currentStyle=currentStyle.replace(/background:[^;]+;?/g,'');$tile.attr('style',currentStyle+'background: '+newStyle+';');}}}function tileBackgroundStyles(){if(settings.masonryFormatter.tileStyles){$('.masonry-item',$grid).off('mouseenter mouseleave focus blur');$('.masonry-item',$grid).on('mouseenter',function(event){replaceBackground($(this),'hover-focus');}).on('mouseleave',function(event){replaceBackground($(this),'default');}).on('focus',function(event){if(event.originalEvent&&event.originalEvent.sourceCapabilities&&event.originalEvent.sourceCapabilities.firesTouchEvents===false)var state='keyboard-focus';else var state='hover-focus';replaceBackground($(this),state);}).on('blur',function(){replaceBackground($(this),'default');});}}$grid.data('breakpoint',getCurrentBreakpoint());initMasonry();tileBackgroundStyles();setTimeout(function(){$grid.masonry('layout');},500);if(!$grid.data('resize-handler-added')){let resizeTimer;$(window).on('resize',function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){resizer();},250);});$grid.data('resize-handler-added',true);}});}};})(jQuery,Drupal,once);;
